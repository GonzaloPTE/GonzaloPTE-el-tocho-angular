<div class="mt-6">
    <app-debounced-category-search-input [initialSearchTerm]="currentSearchTerm" [categoryName]="categoryName"
        [basePath]="basePath"></app-debounced-category-search-input>

    <div *ngIf="isSearching && currentSearchTerm && processedSongs().length > 0"
        class="my-6 p-3 bg-stone-50 dark:bg-stone-800 border border-stone-200 dark:border-stone-700 rounded-lg shadow-sm">
        <p class="text-sm font-medium text-stone-700 dark:text-stone-200 flex items-center">
            <lucide-icon name="search"
                class="w-4 h-4 mr-2 flex-shrink-0 text-stone-500 dark:text-stone-400"></lucide-icon>
            Mostrando resultados para: <strong class="ml-1 font-semibold">"{{ currentSearchTerm }}"</strong>
        </p>
    </div>

    <div *ngIf="processedSongs().length > 0; else emptyState" class="space-y-1 pt-2">
        <a *ngFor="let song of processedSongs()" [routerLink]="['/canciones', song.slug]"
            class="flex items-center space-x-2 sm:space-x-4 p-3 sm:p-4 rounded-xl transition-all duration-200 hover:bg-stone-50 dark:hover:bg-stone-700/60 group border border-transparent hover:border-stone-200 dark:hover:border-stone-700">
            <div
                class="w-10 h-10 sm:w-12 sm:h-12 rounded-full flex-shrink-0 flex items-center justify-center font-semibold text-sm sm:text-lg shadow-inner bg-stone-100 text-stone-700 dark:bg-stone-700 dark:text-stone-200 transition-colors">
                {{ song.code }}
            </div>
            <div class="flex-grow min-w-0">
                <p
                    class="font-semibold text-sm sm:text-lg truncate text-stone-800 dark:text-stone-100 group-hover:text-sky-600 dark:group-hover:text-sky-400 transition-colors">
                    {{ song.title }}</p>
                <p *ngIf="song.author" class="text-xs sm:text-sm truncate text-stone-500 dark:text-stone-400">{{
                    song.author }}</p>
            </div>
            <app-song-item-controls [song]="song"></app-song-item-controls>
            <lucide-icon name="chevron-right"
                class="flex-shrink-0 text-stone-400 dark:text-stone-500 group-hover:text-stone-600 dark:group-hover:text-stone-300 transition-colors"
                [size]="20"></lucide-icon>
        </a>
    </div>

    <ng-template #emptyState>
        <div class="text-center py-12">
            <lucide-icon name="search" class="mx-auto h-12 w-12 text-stone-400 dark:text-stone-500 mb-3"></lucide-icon>
            <p class="text-xl font-semibold text-stone-700 dark:text-stone-300">
                {{ currentSearchTerm
                ? 'No se encontraron canciones para "' + currentSearchTerm + '"'
                : 'No hay canciones en ' + categoryName }}
            </p>
            <p *ngIf="currentSearchTerm" class="mt-2 text-sm text-stone-500 dark:text-stone-400">
                Intenta con otra búsqueda o revisa la ortografía.
            </p>
        </div>
    </ng-template>
</div>